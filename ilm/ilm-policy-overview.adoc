---
permalink: ilm/ilm-policy-overview.html 
sidebar: sidebar 
keywords: ILM policy, information lifecycle policy considerations 
summary: 信息生命周期管理 \ （ ILM ）策略是一组有序的 ILM 规则，用于确定 StorageGRID 系统如何在一段时间内管理对象数据。 
---
= 使用ILM策略
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
信息生命周期管理（ ILM ）策略是一组有序的 ILM 规则，用于确定 StorageGRID 系统如何在一段时间内管理对象数据。


CAUTION: 配置不正确的 ILM 策略可能导致无法恢复的数据丢失。激活 ILM 策略之前，请仔细查看 ILM 策略及其 ILM 规则，然后模拟 ILM 策略。请始终确认 ILM 策略将按预期运行。



== 默认ILM策略

安装StorageGRID并添加站点时、系统会自动创建默认ILM策略、如下所示：

* 如果网格包含一个站点、则默认策略包含一个默认规则、用于复制该站点上每个对象的两个副本。
* 如果网格包含多个站点、则默认规则会复制每个站点上每个对象的一个副本。


如果默认策略不能满足您的存储要求，您可以创建自己的规则和策略。看link:what-ilm-rule-is.html["创建ILM规则"]和link:creating-ilm-policy.html["创建ILM策略"]。



== 一个或多个活动ILM策略？

一次可以有一个或多个活动ILM策略。



=== 一个策略

如果您的网格将使用简单的数据保护方案、其中包含一些租户专用和存储分段专用的规则、请使用一个活动ILM策略。ILM规则可以包含用于管理不同存储分段或租户的筛选器。

image::../media/ilm-policies-single.png[单个ILM策略图表]

如果只有一个策略、而租户的要求发生变化、则必须创建新的ILM策略或克隆现有策略、以应用更改、模拟并激活新的ILM策略。对ILM策略进行更改可能会导致对象移动需要数天时间、并导致发生原因系统延迟。



=== 多个策略

要为租户提供不同的服务质量选项、一次可以有多个活动策略。每个策略都可以管理特定租户、S3分段和对象。为一组特定租户或对象应用或更改一个策略时、应用于其他租户和对象的策略不受影响。

ILM策略标记:: 如果要允许租户在每个存储分段的多个数据保护策略之间轻松切换、请使用多个带有_ILM policy tags_的ILM策略。您可以将每个ILM策略分配给一个标记、然后租户标记一个存储分段以将此策略应用于该存储分段。您只能在S3存储分段上设置ILM策略标记。
+
--
例如、您可能有三个标记、分别名为Gold、Silver和Bronze。您可以根据ILM策略存储对象的时长和位置为每个标记分配ILM策略。租户可以通过标记其存储分段来选择要使用的策略。标记为Gold的存储分段由Gold策略管理、并获得Gold级别的数据保护和性能。

--



NOTE: 你可以link:../ilm/creating-ilm-policy.html#activate-ilm-policy["最多创建 10 个策略标签"]为您的网格。

默认ILM策略标记:: 安装StorageGRID时、系统会自动创建默认ILM策略标记。每个网格都必须有一个分配给默认标记的活动策略。默认策略适用于任何未标记的S3存储分段。


image::../media/ilm-policies-tags-conceptual.png[多个ILM策略图表]



== ILM 策略如何评估对象？

活动ILM策略用于控制对象的放置、持续时间和数据保护。

当客户端将对象保存到StorageGRID时、系统将根据策略中按顺序排列的一组ILM规则对对象进行评估、如下所示：

. 如果策略中第一个规则的筛选器与某个对象匹配，则会根据该规则的载入行为载入该对象，并根据该规则的放置说明进行存储。
. 如果第一个规则的筛选器与对象不匹配、则系统将根据策略中的每个后续规则评估对象、直到进行匹配为止。
. 如果没有与对象匹配的规则，则会应用策略中默认规则的载入行为和放置说明。默认规则是策略中的最后一个规则。默认规则必须应用于所有租户、所有S3分段和所有对象版本、并且不能使用任何高级筛选器。




== ILM 策略示例

例如、一个ILM策略可以包含三个ILM规则、这些规则可指定以下内容：

* *规则1：为租户A*复制的副本
+
** 匹配属于租户A的所有对象
** 将这些对象作为三个复制副本存储在三个站点上。
** 规则1不匹配属于其他租户的对象、因此会根据规则2对其进行评估。


* *规则2：对大于1 MB*的对象进行纠删编码
+
** 匹配其他租户的所有对象、但前提是这些对象大于1 MB。这些较大的对象在三个站点上使用 6+3 纠删编码进行存储。
** 与小于或等于1 MB的对象不匹配、因此将根据规则3评估这些对象。


* *规则3：2个副本2个数据中心*(默认)
+
** 是策略中的最后一个默认规则。不使用筛选器。
** 为规则1或规则2不匹配的所有对象创建两个复制副本(不属于租户A且小于或等于1 MB的对象)。




image::../media/ilm_policy_and_rules.png[ILM 策略和规则]



== 什么是活动策略和非活动策略？

每个StorageGRID系统必须至少具有一个活动ILM策略。如果您希望有多个活动ILM策略、请创建ILM策略标记并为每个标记分配一个策略。然后、租户将标记应用于S3存储分段。默认策略将应用于存储分段中未分配策略标记的所有对象。

首次创建ILM策略时、您可以选择一个或多个ILM规则并按特定顺序进行排列。在模拟策略以确认其行为后、您可以将其激活。

激活一个ILM策略后、StorageGRID将使用该策略来管理所有对象、包括现有对象和新加入的对象。实施新策略中的 ILM 规则后，现有对象可能会移至新位置。

如果一次激活多个ILM策略、而租户将策略标记应用于S3存储分段、则每个存储分段中的对象将根据分配给该标记的策略进行管理。

StorageGRID系统会跟踪已激活或停用的策略的历史记录。



== 创建 ILM 策略的注意事项

* 仅在测试系统中使用系统提供的策略基线2副本策略。对于StorageGRID 11.6及更早版本、此策略中的"创建2个副本"规则将使用包含所有站点的所有存储节点存储池。如果 StorageGRID 系统具有多个站点，则一个对象的两个副本可能会放置在同一站点上。
+

NOTE: 在安装StorageGRID 11.6及更早版本期间、系统会自动创建所有存储节点存储池。如果升级到更高版本的StorageGRID 、则所有存储节点池仍将存在。如果全新安装StorageGRID 11.7或更高版本、则不会创建所有存储节点池。

* 在设计新策略时，请考虑可能会输入到网格中的所有不同类型的对象。确保此策略包含与这些对象匹配并根据需要放置这些对象的规则。
* 尽量使 ILM 策略简单。这样可以避免在随时间推移对 StorageGRID 系统进行更改时，对象数据无法按预期得到保护的潜在危险情况。
* 确保策略中的规则顺序正确。激活策略后，新对象和现有对象将按列出的顺序从顶部开始进行评估。例如、如果策略中的第一个规则与某个对象匹配、则该对象不会由任何其他规则进行评估。
* 每个ILM策略中的最后一条规则是默认ILM规则、不能使用任何筛选器。如果某个对象未被其他规则匹配，则默认规则将控制该对象的放置位置以及保留时间。
* 在激活新策略之前，请查看此策略对现有对象的放置所做的任何更改。在评估和实施新放置时，更改现有对象的位置可能会导致临时资源问题。

