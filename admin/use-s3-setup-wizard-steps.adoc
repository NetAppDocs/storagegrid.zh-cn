---
permalink: admin/use-s3-setup-wizard-steps.html 
sidebar: sidebar 
keywords: FabricPool and S3 setup wizard, object storage system, S3 application 
summary: 您可以使用S3设置向导将StorageGRID 配置为S3应用程序的对象存储系统。 
---
= 访问并完成S3设置向导
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
您可以使用S3设置向导配置StorageGRID 以用于S3应用程序。设置向导提供了应用程序访问StorageGRID 存储分段和保存对象所需的值。

.开始之前
* 您拥有link:admin-group-permissions.html["root访问权限"]。
* 您已查看link:use-s3-setup-wizard.html["注意事项和要求"]以使用向导。




== 访问向导

.步骤
. 使用登录到网格管理器link:web-browser-requirements.html["支持的 Web 浏览器"]。
. 如果信息板上显示了FabricPool and S3 setup wizard*横幅，请选择横幅中的链接。如果横幅不再显示，请从网格管理器的标题栏中选择帮助图标，然后选择FabricPool and S3 setup wizard*。
+
image::../media/help_menu.png[帮助菜单]

. 在FabricPool and S3设置向导页面的S3应用程序部分中，选择*立即配置*。




== 第1步(共6步)：配置HA组

HA组是一组节点、每个节点都包含StorageGRID 负载平衡器服务。HA组可以包含网关节点、管理节点或同时包含这两者。

您可以使用HA组帮助保持S3数据连接可用。如果HA组中的活动接口发生故障、备份接口可以管理工作负载、而对S3操作的影响微乎其微。

有关此任务的详细信息，请参见link:managing-high-availability-groups.html["管理高可用性组"]。

.步骤
. 如果您计划使用外部负载平衡器、则无需创建HA组。选择*跳过此步骤*并转到<<第2步(共6步)：配置负载平衡器端点>>。
. 要使用StorageGRID 负载平衡器、您可以创建新的HA组或使用现有HA组。
+
[role="tabbed-block"]
====
.创建 HA 组
--
.. 要创建新的HA组，请选择*创建HA组*。
.. 对于“*输入详细信息*”步骤，请填写以下字段。
+
[cols="1a,2a"]
|===
| 字段 | 说明 


 a| 
HA组名称
 a| 
此HA组的唯一显示名称。



 a| 
问题描述 (可选)
 a| 
此HA组的问题描述。

|===
.. 对于*Add interfaces*步骤，选择要在此HA组中使用的节点接口。
+
使用列标题对行进行排序，或者输入搜索词以更快地找到接口。

+
您可以选择一个或多个节点、但只能为每个节点选择一个接口。

.. 对于“确定接口优先级”步骤，请确定此HA组的主接口和任何备份接口。
+
拖动行以更改*优先级顺序*列中的值。

+
列表中的第一个接口是主接口。主接口是活动接口，除非发生故障。

+
如果HA组包含多个接口、而活动接口发生故障、则虚拟IP (VIP)地址将按优先级顺序移至第一个备份接口。如果该接口发生故障， VIP 地址将移至下一个备份接口，依此类推。解决故障后、VIP地址将移回可用的最高优先级接口。

.. 对于“*输入IP地址*”步骤，请填写以下字段。
+
[cols="1a,2a"]
|===
| 字段 | 说明 


 a| 
Subnet CIDR
 a| 
采用CIDR表示法的VIP子网地址&#8212；后跟斜杠的IPv4地址和子网长度(0-32)。

网络地址不能设置任何主机位。例如， `192.16.0.0/22`。



 a| 
网关IP地址(可选)
 a| 
如果用于访问StorageGRID 的S3 IP地址与StorageGRID VIP地址不在同一子网上、请输入StorageGRID VIP本地网关IP地址。本地网关 IP 地址必须位于 VIP 子网中。



 a| 
虚拟IP地址
 a| 
为HA组中的活动接口至少输入一个VIP地址、最多输入十个VIP地址。所有VIP地址都必须位于VIP子网内。

必须至少有一个地址为IPv4。您也可以指定其他 IPv4 和 IPv6 地址。

|===
.. 选择*创建HA组*，然后选择*完成*返回S3设置向导。
.. 选择*继续*以转到负载平衡器步骤。


--
.使用现有HA组
--
.. 要使用现有HA组，请从*选择HA组*中选择HA组名称。
.. 选择*继续*以转到负载平衡器步骤。


--
====




== 第2步(共6步)：配置负载平衡器端点

StorageGRID 使用负载平衡器管理客户端应用程序中的工作负载。负载平衡可最大限度地提高多个存储节点的速度和连接容量。

您可以使用所有网关和管理节点上的StorageGRID 负载平衡器服务、也可以连接到外部(第三方)负载平衡器。建议使用StorageGRID 负载平衡器。

有关此任务的详细信息，请参见link:managing-load-balancing.html["负载平衡注意事项"]。

要使用StorageGRID 负载平衡器服务，请选择StorageGRID 负载平衡器*选项卡，然后创建或选择要使用的负载平衡器端点。要使用外部负载平衡器，请选择*外部负载平衡器*选项卡，并提供有关已配置的系统的详细信息。

[role="tabbed-block"]
====
.创建端点
--
.步骤
. 要创建负载平衡器端点，请选择*Create endpoint*。
. 对于*输入端点详细信息*步骤，请填写以下字段。
+
[cols="1a,2a"]
|===
| 字段 | 说明 


 a| 
名称
 a| 
端点的描述性名称。



 a| 
端口
 a| 
要用于负载平衡的 StorageGRID 端口。对于您创建的第一个端点、此字段默认为10433、但您可以输入任何未使用的外部端口。如果输入80或443、则仅在网关节点上配置端点、因为这些端口是在管理节点上预留的。

*注意：*不允许使用其他网格服务使用的端口。请参见link:../network/network-port-reference.html["网络端口参考"]。



 a| 
客户端类型
 a| 
必须为*S3*。



 a| 
网络协议
 a| 
选择 * HTTPS * 。

*注意*：支持在不使用TLS加密的情况下与StorageGRID 通信，但不建议这样做。

|===
. 对于*选择绑定模式*步骤，指定绑定模式。绑定模式控制如何使用任何IP地址或特定IP地址和网络接口访问端点。
+
[cols="1a,3a"]
|===
| 模式 | 说明 


 a| 
全局（默认）
 a| 
客户端可以使用任何网关节点或管理节点的IP地址、任何网络上任何HA组的虚拟IP (VIP)地址或相应的FQDN访问端点。

除非需要限制此端点的可访问性，否则请使用 * 全局 * 设置（默认）。



 a| 
HA 组的虚拟 IP
 a| 
客户端必须使用HA组的虚拟IP地址(或相应的FQDN)才能访问此端点。

具有此绑定模式的端点都可以使用相同的端口号、只要为端点选择的HA组不重叠即可。



 a| 
节点接口
 a| 
客户端必须使用选定节点接口的IP地址(或相应FQDN)才能访问此端点。



 a| 
节点类型
 a| 
根据您选择的节点类型、客户端必须使用任何管理节点的IP地址(或相应的FQDN)或任何网关节点的IP地址(或相应的FQDN)来访问此端点。

|===
. 对于租户访问步骤、选择以下选项之一：
+
[cols="1a,2a"]
|===
| 字段 | 说明 


 a| 
允许所有租户(默认)
 a| 
所有租户帐户都可以使用此端点来访问其分段。



 a| 
允许选定租户
 a| 
只有选定租户帐户才能使用此端点访问其分段。



 a| 
阻止选定租户
 a| 
选定租户帐户无法使用此端点访问其分段。所有其他租户均可使用此端点。

|===
. 对于*attach certificer*步骤，选择以下选项之一：
+
[cols="1a,2a"]
|===
| 字段 | 说明 


 a| 
上传证书(建议)
 a| 
使用此选项可上传CA签名的服务器证书、证书专用密钥和可选的CA包。



 a| 
生成证书
 a| 
使用此选项可生成自签名证书。有关输入内容的详细信息、请参见link:configuring-load-balancer-endpoints.html["配置负载平衡器端点"]。



 a| 
使用StorageGRID S3证书
 a| 
仅当您已上传或生成自定义版本的StorageGRID 全局证书时、才使用此选项。有关详细信息、请参见。 link:configuring-custom-server-certificate-for-storage-node.html["配置S3 API证书"]

|===
. 选择*完成*以返回S3设置向导。
. 选择*继续*转到租户和存储分段步骤。



NOTE: 对端点证书所做的更改可能需要长达 15 分钟才能应用于所有节点。

--
.使用现有负载平衡器端点
--
.步骤
. 要使用现有端点，请从*选择负载平衡器端点*中选择其名称。
. 选择*继续*转到租户和存储分段步骤。


--
.使用外部负载平衡器
--
.步骤
. 要使用外部负载平衡器、请填写以下字段。
+
[cols="1a,2a"]
|===
| 字段 | 说明 


 a| 
FQDN
 a| 
外部负载平衡器的完全限定域名(FQDN)。



 a| 
端口
 a| 
S3应用程序将用于连接到外部负载平衡器的端口号。



 a| 
证书
 a| 
复制外部负载平衡器的服务器证书并将其粘贴到此字段中。

|===
. 选择*继续*转到租户和存储分段步骤。


--
====


== 第3步(共6步)：创建租户和存储分段

租户是一种可以使用S3应用程序在StorageGRID 中存储和检索对象的实体。每个租户都有自己的用户、访问密钥、分段、对象和一组特定功能。

分段是一种用于存储租户对象和对象元数据的容器。尽管租户可能具有许多存储分段、但此向导可帮助您以最快、最简单的方式创建租户和存储分段。如果稍后需要添加存储分段或设置选项、可以使用租户管理器。

有关此任务的详细信息，请参见link:creating-tenant-account.html["创建租户帐户"]和link:../tenant/creating-s3-bucket.html["创建 S3 存储分段"]。

.步骤
. 输入租户帐户的名称。
+
租户名称不需要唯一。创建租户帐户时，它会收到一个唯一的数字帐户 ID 。

. 根据您的StorageGRID系统是使用link:using-identity-federation.html["身份联合"]、link:how-sso-works.html["单点登录(SSO)"]还是同时使用这两者，定义租户帐户的root访问权限。
+
[cols="1a,2a"]
|===
| 选项 | 执行此操作 ... 


 a| 
如果未启用身份联合
 a| 
指定以本地root用户身份登录租户时要使用的密码。



 a| 
如果启用了身份联合
 a| 
.. 选择租户要拥有的现有联盟组link:../tenant/tenant-management-permissions.html["root访问权限"]。
.. (可选)指定以本地root用户身份登录到租户时要使用的密码。




 a| 
如果同时启用了身份联合和单点登录(SSO)
 a| 
选择租户要拥有的现有联盟组link:../tenant/tenant-management-permissions.html["root访问权限"]。没有本地用户可以登录。

|===
. 如果希望向导为root用户创建访问密钥ID和机密访问密钥，请选择*自动创建root用户S3访问密钥*。
+
如果租户的唯一用户是root用户、请选择此选项。如果其他用户要使用此租户、则link:../tenant/index.html["使用租户管理器"]配置密钥和权限。

. 如果要立即为此租户创建存储分段，请选择*为此租户创建存储分段*。
+

TIP: 如果为网格启用了S3对象锁定、则在此步骤中创建的分段不会启用S3对象锁定。如果您需要对此S3应用程序使用S3对象锁定分段、请勿选择立即创建分段。请稍后使用租户管理器link:../tenant/creating-s3-bucket.html["创建存储分段"]。

+
.. 输入S3应用程序要使用的存储分段的名称。例如， `s3-bucket`。
+
创建存储分段后、无法更改存储分段名称。

.. 为此存储分段选择*区域*。
+
使用默认区域(`us-east-1`)，除非您希望将来使用ILM根据存储分段的区域过滤对象。



. 选择*创建并继续*。




== [[download-data]]第4步(共6步)：下载数据

在下载数据步骤中、您可以下载一个或两个文件以保存刚刚配置的内容的详细信息。

.步骤
. 如果选择了*自动创建root用户S3访问密钥*，请执行以下一项或两项操作：
+
** 选择*下载访问密钥*可下载 `.csv`包含租户帐户名称、访问密钥ID和机密访问密钥的文件。
** 选择复制图标image:../media/icon_tenant_copy_url.png["复制图标"]()，将访问密钥ID和机密访问密钥复制到剪贴板。


. 选择*下载配置值*可下载 `.txt`包含负载平衡器端点、租户、分段和root用户设置的文件。
. 将此信息保存到安全位置。
+

CAUTION: 在复制两个访问密钥之前、请勿关闭此页面。关闭此页面后、密钥将不可用。请确保将此信息保存在安全位置、因为此信息可用于从StorageGRID 系统获取数据。

. 如果出现提示、请选中此复选框以确认您已下载或复制密钥。
. 选择*继续*以转到ILM规则和策略步骤。




== 第5步(共6步)：查看S3的ILM规则和ILM策略

信息生命周期管理(ILM)规则控制StorageGRID 系统中所有对象的放置、持续时间和加载行为。StorageGRID 附带的ILM策略会为所有对象创建两个复制副本。此策略在您至少激活一个新策略之前有效。

.步骤
. 查看页面上提供的信息。
. 如果要为属于新租户或存储分段的对象添加特定说明、请创建新规则和新策略。请参阅link:../ilm/access-create-ilm-rule-wizard.html["创建 ILM 规则"]和link:../ilm/ilm-policy-overview.html["使用ILM策略"]。
. 选择*我已查看这些步骤并了解我需要执行的操作*。
. 选中此复选框以指示您了解下一步要做什么。
. 选择*继续*以转到*摘要*。




== 第6步(共6步)：查看摘要

.步骤
. 查看摘要。
. 记下后续步骤中的详细信息、这些详细信息介绍了在连接到S3客户端之前可能需要的其他配置。例如，选择*以root身份登录*将转到租户管理器，您可以在其中添加租户用户、创建其他存储分段以及更新存储分段设置。
. 选择 * 完成 * 。
. 使用从StorageGRID 下载的文件或手动获取的值配置应用程序。

