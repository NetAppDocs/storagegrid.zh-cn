---
permalink: admin/grid-federation-manage-tenants.html 
sidebar: sidebar 
keywords: grid federation, manage tenant, use grid federation permission, remove permission, cross grid replication 
summary: 您可以允许S3租户帐户在两个StorageGRID系统之间使用网格联合连接。如果允许租户使用连接、则需要执行特殊步骤来编辑租户详细信息或永久删除租户使用连接的权限。 
---
= 管理网格联盟允许的租户
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
您可以允许S3租户帐户在两个StorageGRID系统之间使用网格联合连接。如果允许租户使用连接、则需要执行特殊步骤来编辑租户详细信息或永久删除租户使用连接的权限。

.开始之前
* 您已使用登录到任一网格上的网格管理器link:../admin/web-browser-requirements.html["支持的 Web 浏览器"]。
* 您拥有已登录到的网格的link:admin-group-permissions.html["root访问权限"]。
* 两个网格之间存在link:grid-federation-create-connection.html["已创建网格联合连接"]。
* 您已查看和的工作流link:grid-federation-what-is-account-clone.html["帐户克隆"]link:grid-federation-what-is-cross-grid-replication.html["跨网格复制"]。
* 根据需要、您已为连接中的两个网格配置单点登录(SSO)或标识联合。请参阅。 link:grid-federation-what-is-account-clone.html["什么是帐户克隆"]




== 创建允许的租户

如果要允许新的或现有的租户帐户使用网格联合连接进行帐户克隆和跨网格复制、请按照或的link:editing-tenant-account.html["编辑租户帐户"]常规说明进行操作、link:creating-tenant-account.html["创建新的S3租户"]并注意以下事项：

* 您可以从连接中的任一网格创建租户。创建租户的网格是_租 户的源网格_。
* 连接状态必须为*已连接*。
* 在创建或编辑租户以启用*使用网格联合连接*权限并将其保存在第一个网格上后、相同的租户将自动复制到另一个网格。复制租户的网格是_租 户的目标网格_。
* 两个网格上的租户将具有相同的20位数帐户ID、名称、问题描述 、配额和权限。您也可以使用*问题描述 *字段帮助确定哪个是源租户、哪个是目标租户。例如、对于在网格1上创建的租户、如果该租户复制到网格2、则也会显示此问题描述 ："This租户was created on Grid 1"(此租户已在网格1上创建)。
* 出于安全原因、本地root用户的密码不会复制到目标网格。
+

TIP: 本地root用户登录到目标网格上的复制租户之前，该网格的网格管理员必须link:changing-password-for-tenant-local-root-user.html["更改本地root用户的密码"]。

* 在两个网格上都有新租户或编辑过的租户后、租户用户可以执行以下操作：
+
** 从租户的源网格中、创建组和本地用户、这些组和本地用户会自动克隆到租户的目标网格。请参阅。 link:../tenant/grid-federation-account-clone.html["克隆租户组和用户"]
** 创建新的S3访问密钥、可以选择将这些密钥克隆到租户的目标网格。请参阅。 link:../tenant/grid-federation-clone-keys-with-api.html["使用API克隆S3访问密钥"]
** 在连接中的两个网格上创建相同的分段、并在一个方向或两个方向上启用跨网格复制。请参阅。 link:../tenant/grid-federation-manage-cross-grid-replication.html["管理跨网格复制"]






== 查看允许的租户

您可以查看允许使用网格联盟连接的租户的详细信息。

.步骤
. 选择 * 租户 * 。
. 从租户页面中、选择租户名称以查看租户详细信息页面。
+
如果这是租户的源网格(即、如果租户是在此网格上创建的)、则会显示一个横幅、提醒您租户已克隆到另一个网格。如果编辑或删除此租户、您所做的更改不会同步到其他网格。

+
image::../media/grid-federation-tenant-detail.png["租户详细信息"页面上的"网格联盟"选项卡]

. (可选)选择*网格联合*选项卡link:../monitor/grid-federation-monitor-connections.html["监控网格联合连接"]。




== 编辑允许的租户

如果您需要编辑具有*使用网格联合连接*权限的租户、请按照的常规说明进行操作link:editing-tenant-account.html["编辑租户帐户"]、并注意以下事项：

* 如果租户具有*使用网格联合连接*权限、您可以从连接中的任一网格编辑租户详细信息。但是、您所做的任何更改都不会复制到另一个网格。如果要使租户详细信息在网格之间保持同步、则必须在两个网格上进行相同的编辑。
* 编辑租户时无法清除*使用网格联合连接*权限。
* 编辑租户时、不能选择其他网格联合连接。




== 删除允许的租户

如果您需要删除具有*使用网格联合连接*权限的租户、请按照的常规说明进行操作link:deleting-tenant-account.html["删除租户帐户"]、并注意以下事项：

* 在删除源网格上的原始租户之前、必须先删除源网格上帐户的所有分段。
* 在删除目标网格上的克隆租户之前、必须先删除目标网格上帐户的所有分段。
* 如果删除原始租户或克隆的租户、则帐户将无法再用于跨网格复制。
* 如果要删除源网格上的原始租户、则克隆到目标网格的任何租户组、用户或密钥都不会受到影响。您可以删除克隆的租户、也可以允许其管理自己的组、用户、访问密钥和分段。
* 如果要删除目标网格上的克隆租户、则在向原始租户添加新组或用户时将发生克隆错误。
+
要避免这些错误、请先删除租户使用网格联合连接的权限、然后再从此网格中删除租户。





== [[remove-grid联合身份验证-connection权限]]删除使用网格联合连接权限

要防止租户使用网格联合连接、您必须删除*使用网格联合连接*权限。

image::../media/grid-federation-remove-permission.png[删除网格联合连接的步骤]

在删除租户使用网格联合连接的权限之前、请注意以下事项：

* 如果租户的任何分段已启用跨网格复制、则无法删除*使用网格联合连接*权限。租户帐户必须先为其所有分段禁用跨网格复制。
* 删除*使用网格联合连接*权限不会删除已在网格之间复制的任何项目。例如、删除租户的权限后、不会从任一网格中删除存在于两个网格上的任何租户用户、组和对象。如果要删除这些项目、则必须手动将其从两个网格中删除。
* 如果要使用相同的网格联合连接重新启用此权限、请先删除目标网格上的此租户；否则、重新启用此权限将导致出现错误。



NOTE: 重新启用*使用网格联合连接*权限会使本地网格成为源网格，并触发向选定网格联合连接指定的远程网格的克隆。如果远程网格上已存在租户帐户、则克隆将导致冲突错误。

.开始之前
* 您正在使用link:../admin/web-browser-requirements.html["支持的 Web 浏览器"]。
* 两个网格都有link:admin-group-permissions.html["root访问权限"]。




=== 禁用租户分段复制

首先、对所有租户分段禁用跨网格复制。

.步骤
. 从任一网格开始、从主管理节点登录到网格管理器。
. 选择*configuration*>*System*>*Grid Federation。
. 选择连接名称以显示其详细信息。
. 在*允许的租户*选项卡上、确定租户是否正在使用此连接。
. 如果列出了租户、则指示其对连接中两个网格上的所有分段执行link:../tenant/grid-federation-manage-cross-grid-replication.html["禁用跨网格复制"]。
+

TIP: 如果任何租户分段已启用跨网格复制、则无法删除*使用网格联合连接*权限。租户必须在两个网格上为其分段禁用跨网格复制。





=== 删除租户的权限

为租户分段禁用跨网格复制后、您可以删除租户使用网格联合连接的权限。

.步骤
. 从主管理节点登录到网格管理器。
. 从"网格联盟"页面或"租户"页面中删除此权限。
+
[role="tabbed-block"]
====
.网格联合页面
--
.. 选择*configuration*>*System*>*Grid Federation。
.. 选择连接名称以显示其详细信息页面。
.. 在*允许的租户*选项卡上、选择租户的单选按钮。
.. 选择*删除权限*。


--
.租户页面
--
.. 选择 * 租户 * 。
.. 选择租户的名称以显示详细信息页面。
.. 在*网格联盟*选项卡上，选择连接的单选按钮。
.. 选择*删除权限*。


--
====
. 查看确认对话框中的警告，然后选择*Remove*。
+
** 如果可以删除此权限、则会返回到详细信息页面、并显示一条成功消息。此租户无法再使用网格联合连接。
** 如果一个或多个租户分段仍启用了跨网格复制、则会显示错误。
+
image::../media/grid-federation-remove-permission-error.png[如果租户为存储分段启用了CGR、则会显示错误消息]

+
您可以执行以下任一操作：

+
*** (建议。)登录到租户管理器并为租户的每个分段禁用复制。请参阅。 link:../tenant/grid-federation-manage-cross-grid-replication.html["管理跨网格复制"]然后，重复这些步骤以删除*使用网格连接*权限。
*** 强制删除权限。请参见下一节。




. 转到另一个网格并重复这些步骤、以删除另一个网格上同一租户的权限。




== [[FORCE-Remove_Permission ]]强制删除权限

如有必要、您可以强制删除租户使用网格联合连接的权限、即使租户分段已启用跨网格复制也是如此。

在强制删除租户的权限之前、请注意的一般注意事项<<remove-grid-federation-connection-permission,正在删除权限>>以及以下附加注意事项：

* 如果您强制删除*使用网格联合连接*权限，则所有正在等待复制到另一网格的对象(已加载但尚未复制)将继续被复制。为了防止这些进程中对象到达目标存储分段、您还必须删除租户对其他网格的权限。
* 删除*使用网格联合连接*权限后、插入到源存储分段中的任何对象都不会复制到目标存储分段。


.步骤
. 从主管理节点登录到网格管理器。
. 选择*configuration*>*System*>*Grid Federation。
. 选择连接名称以显示其详细信息页面。
. 在*允许的租户*选项卡上、选择租户的单选按钮。
. 选择*删除权限*。
. 查看确认对话框中的警告，然后选择*Force remove*。
+
此时将显示一条成功消息。此租户无法再使用网格联合连接。

. 根据需要、转到另一个网格并重复这些步骤、以强制删除另一个网格上同一租户帐户的权限。例如、您应在其他网格上重复这些步骤、以防止进程中对象到达目标分段。

