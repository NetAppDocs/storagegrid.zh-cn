---
permalink: maintain/considerations-for-removing-site.html 
sidebar: sidebar 
keywords: how to remove site 
summary: 在使用站点停用操作步骤 删除站点之前，您必须查看注意事项。 
---
= 删除站点的注意事项
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
在使用站点停用操作步骤 删除站点之前，您必须查看注意事项。



== 停用站点时会发生什么情况

停用站点时， StorageGRID 会从 StorageGRID 系统中永久删除站点上的所有节点以及站点本身。

站点停用操作步骤 完成后：

* 您不能再使用 StorageGRID 查看或访问站点或站点上的任何节点。
* 您无法再使用引用该站点的任何存储池或纠删编码配置文件。StorageGRID停用站点时、会自动删除这些存储池并停用这些纠删编码配置文件。




== 已连接站点与已断开站点停用过程之间的差异

您可以使用站点停用操作步骤 删除所有节点均已连接到 StorageGRID 的站点（称为已连接站点停用），或者删除所有节点均已与 StorageGRID 断开连接的站点（称为已断开连接的站点停用）。开始之前，您必须了解这些过程之间的差异。


NOTE: 如果某个站点同时包含已连接()和已断开连接的image:../media/icon_alert_green_checkmark.png["图标警报绿色复选标记"]节点(image:../media/icon_alarm_gray_administratively_down.png["图标警报灰色已管理员关闭"]或image:../media/icon_alarm_blue_unknown.png["图标警报蓝色未知"])，则必须将所有脱机节点恢复联机。

* 通过已连接站点停用，您可以从 StorageGRID 系统中删除操作站点。例如，您可以执行已连接站点停用以删除正常运行但不再需要的站点。
* 当 StorageGRID 删除已连接站点时，它会使用 ILM 管理该站点上的对象数据。在开始停用已连接站点之前，必须先从所有 ILM 规则中删除此站点并激活新的 ILM 策略。迁移对象数据的 ILM 过程和删除站点的内部过程可以同时进行，但最佳实践是，在开始实际停用操作步骤 之前，允许完成 ILM 步骤。
* 断开连接的站点停用允许您从 StorageGRID 系统中删除故障站点。例如，您可以执行已断开连接的站点停用，以删除已被火灾或洪水破坏的站点。
+
当 StorageGRID 删除已断开连接的站点时，它会将所有节点视为不可恢复的，并且不会尝试保留数据。但是，在开始执行已断开连接的站点停用之前，必须先从所有 ILM 规则中删除此站点并激活新的 ILM 策略。

+

CAUTION: 在执行已断开连接的站点停用操作步骤 之前，您必须联系您的 NetApp 客户代表。在取消配置站点向导中启用所有步骤之前， NetApp 将查看您的要求。如果您认为可以恢复站点或从站点恢复对象数据，则不应尝试执行已断开连接的站点停用。





== 删除已连接或已断开连接的站点的一般要求

在删除已连接或已断开连接的站点之前，您必须了解以下要求：

* 您不能停用包含主管理节点的站点。
* 如果任何节点的接口属于高可用性(HA)组、则无法停用站点。您必须编辑 HA 组以删除节点的接口或删除整个 HA 组。
* 如果某个站点同时包含已连接()和已断开连接(或image:../media/icon_alarm_gray_administratively_down.png["图标警报灰色已管理员关闭"])的节点，image:../media/icon_alarm_blue_unknown.png["图标警报蓝色未知"]则不能停用该站点image:../media/icon_alert_green_checkmark.png["图标警报绿色复选标记"]。
* 如果任何其他站点上的任何节点已断开连接(或image:../media/icon_alarm_gray_administratively_down.png["图标警报灰色已管理员关闭"])，则无法停用站点image:../media/icon_alarm_blue_unknown.png["图标警报蓝色未知"]。
* 如果正在执行EC节点修复操作、则无法启动站点停用操作步骤。请参见link:checking-data-repair-jobs.html["检查数据修复作业"]以跟踪经过过整编码的数据的修复。
* 站点停用操作步骤 运行时：
+
** 您不能创建引用要停用的站点的ILM规则。您也无法编辑现有ILM规则以引用此站点。
** 您无法执行其他维护过程、例如扩展或升级。
+

NOTE: 如果您需要在已连接站点停用期间执行另一个维护过程，您可以link:pausing-and-resuming-decommission-process-for-storage-nodes.html["在删除存储节点时暂停操作步骤"]。只有在达到 ILM 评估或纠删编码的数据停用阶段时， * 暂停 * 按钮才会启用；但是， ILM 评估（数据迁移）将继续在后台运行。第二个维护操作步骤 完成后，您可以恢复停用。

** 如果您需要在启动站点停用操作步骤 后恢复任何节点，必须联系支持部门。


* 一次不能停用多个站点。
* 如果站点包含一个或多个管理节点，并且为 StorageGRID 系统启用了单点登录（ Single Sign-On ， SSO ），则必须从 Active Directory 联合身份验证服务（ Active Directory Federation Services ， AD FS ）中删除此站点的所有依赖方信任。




== 信息生命周期管理（ ILM ）的要求

在删除站点时，您必须更新 ILM 配置。" 取消配置站点 " 向导将指导您完成许多前提条件步骤，以确保满足以下要求：

* 此站点不受任何ILM策略的引用。如果是、则必须编辑策略、或者创建策略并使用新的ILM规则激活策略。
* 任何ILM规则都不会引用此站点、即使这些规则未在任何策略中使用也是如此。您必须删除或编辑引用此站点的所有规则。


在StorageGRID停用站点时、它会自动停用引用该站点的任何未使用的纠删编码配置文件、并自动删除引用该站点的任何未使用的存储池。如果存在所有存储节点存储池(StorageGRID 11.6及更早版本)、则会将其删除、因为它会使用所有站点。


CAUTION: 在删除站点之前，您可能需要创建新的 ILM 规则并激活新的 ILM 策略。以下说明假定您已充分了解ILM的工作原理、并熟悉创建存储池、纠删编码配置文件、ILM规则以及模拟和激活ILM策略。请参阅。 link:../ilm/index.html["使用 ILM 管理对象"]



== 已连接站点上的对象数据注意事项

如果要执行已连接站点停用，则必须在创建新的 ILM 规则和新的 ILM 策略时确定如何处理站点上的现有对象数据。您可以执行以下任一操作，也可以同时执行这两项操作：

* 将对象数据从选定站点移动到网格中的一个或多个其他站点。
+
* 移动数据的示例 * ：假设您要停用罗利的某个站点，因为您在森尼韦尔添加了一个新站点。在此示例中，您希望将所有对象数据从旧站点移动到新站点。在更新ILM规则和ILM策略之前、您必须查看这两个站点的容量。您必须确保森尼韦尔站点具有足够的容量来容纳来自罗利站点的对象数据，并且森尼韦尔将保留足够的容量以满足未来增长的需要。

+

NOTE: 要确保有足够的可用容量、您可能需要link:../expand/index.html["扩展网格"]在执行此过程之前向现有站点添加存储卷或存储节点、或者添加新站点。

* 从选定站点删除对象副本。
+
* 删除数据的示例 * ：假设您当前使用 3 个副本 ILM 规则在三个站点之间复制对象数据。在停用站点之前，您可以创建等效的双副本 ILM 规则，以便仅将数据存储在两个站点上。激活使用双副本规则的新 ILM 策略时， StorageGRID 会从第三个站点删除这些副本，因为它们不再满足 ILM 要求。但是，对象数据仍会受到保护，其余两个站点的容量将保持不变。

+

CAUTION: 切勿创建单个副本 ILM 规则来容纳站点的删除。如果 ILM 规则在任何时间段内仅创建一个复制副本，则会使数据面临永久丢失的风险。如果某个对象只存在一个复制副本，则在存储节点出现故障或出现严重错误时，该对象将丢失。在升级等维护过程中，您还会暂时失去对对象的访问权限。





== 已连接站点停用的其他要求

在 StorageGRID 删除已连接站点之前，您必须确保满足以下条件：

* StorageGRID系统中的所有节点的连接状态都必须为*conny*()image:../media/icon_alert_green_checkmark.png["图标警报绿色复选标记"]；但是，这些节点可以具有活动警报。
+

NOTE: 如果一个或多个节点断开连接，您可以完成 " 取消配置站点 " 向导的步骤 1-4 。但是、除非所有节点均已连接、否则无法完成向导中启动停用过程的步骤5。

* 如果您计划删除的站点包含用于负载平衡的网关节点或管理节点、则可能需要link:../expand/index.html["扩展网格"]在另一站点添加等效的新节点。在启动站点停用操作步骤 之前，请确保客户端可以连接到替代节点。
* 如果要删除的站点包含高可用性（ HA ）组中的任何网关节点或管理节点，则可以完成 " 取消配置站点 " 向导的步骤 1-4 。但是、在从所有HA组中删除这些节点之前、您无法完成向导中启动停用过程的步骤5。如果现有客户端连接到包含站点中节点的 HA 组，则必须确保它们可以在删除站点后继续连接到 StorageGRID 。
* 如果客户端直接连接到您要删除的站点上的存储节点，则必须确保它们可以连接到其他站点上的存储节点，然后再启动站点停用操作步骤 。
* 您必须在其余站点上提供足够的空间、以容纳因任何活动ILM策略发生更改而要移动的任何对象数据。在某些情况下、您可能需要link:../expand/index.html["扩展网格"]先添加存储节点、存储卷或新站点、然后才能完成已连接站点的停用。
* 您必须留出足够的时间来完成停用操作步骤 。StorageGRID ILM 过程可能需要数天，数周甚至数月才能从站点中移动或删除对象数据，然后才能停用此站点。
+

NOTE: 从站点移动或删除对象数据可能需要数天，数周甚至数月的时间，具体取决于站点上的数据量，系统上的负载，网络延迟以及所需 ILM 更改的性质。

* 您应尽可能早地完成 " 弃用站点 " 向导的步骤 1-4 。如果您允许在启动实际停用操作步骤 之前从站点移动数据，则停用操作步骤 将更快地完成，并且中断和性能影响更少（方法是在向导的步骤 5 中选择 * 启动停用 * ）。




== 断开连接的站点停用的其他要求

在 StorageGRID 删除已断开连接的站点之前，您必须确保满足以下条件：

* 您已联系您的 NetApp 客户代表。在取消配置站点向导中启用所有步骤之前， NetApp 将查看您的要求。
+

CAUTION: 如果您认为可以恢复站点或从站点恢复任何对象数据，则不应尝试执行已断开连接的站点停用。请参阅。 link:how-site-recovery-is-performed-by-technical-support.html["技术支持如何恢复站点"]

* 站点上的所有节点的连接状态必须为以下之一：
+
** *Unknown*image:../media/icon_alarm_blue_unknown.png["图标警报蓝色未知"]()：由于未知原因，节点断开连接或节点上的服务意外关闭。例如，节点上的服务可能已停止，或者节点可能已因电源故障或意外中断而丢失网络连接。
** *administratively down *image:../media/icon_alarm_gray_administratively_down.png["图标警报灰色已管理员关闭"]()：由于预期原因，节点未连接到网格。例如，节点上的一个或多个节点已正常关闭。


* 所有其他站点上的所有节点的连接状态必须为*connonny*()image:../media/icon_alert_green_checkmark.png["图标警报绿色复选标记"]；但是，这些其他节点可能具有活动警报。
* 您必须了解，您将无法再使用 StorageGRID 查看或检索站点上存储的任何对象数据。当 StorageGRID 执行此操作步骤 时，它不会尝试保留已断开连接的站点中的任何数据。
+

NOTE: 如果您的 ILM 规则和策略旨在防止单个站点丢失，则其余站点上仍存在对象的副本。

* 您必须了解、如果站点包含对象的唯一副本、则对象将丢失、并且无法检索。




== 删除站点时的一致性注意事项

S3存储分段的一致性决定了StorageGRID是否在通知客户端对象已成功执行对象加热之前将对象元数据完全复制到所有节点和站点。一致性可在不同存储节点和站点之间的对象可用性与这些对象的一致性之间实现平衡。

StorageGRID 删除站点时，需要确保不会向要删除的站点写入任何数据。因此、它会临时覆盖每个存储分段或容器的一致性。启动站点停用过程后， StorageGRID 会暂时使用强站点一致性来防止将对象元数据写入要删除的站点。

由于这种临时覆盖，请注意，如果其他站点上的多个节点不可用，则站点停用期间发生的任何客户端写入，更新和删除操作都可能失败。
